---
title: 实时业务数据库对比：MySQL、PostgreSQL、MongoDB
description: >-
  本文提供了三种常用数据库系统的比较概述：MySQL、PostgreSQL 和
  MongoDB。介绍了它们的核心特性，突出了它们在数据建模、性能、可扩展性、社区支持等各个方面的优缺点，并概述了它们的典型应用场景。目标是帮助读者了解每个系统的优势和局限性，并指导他们选择最适合其特定需求的数据库。
editLink: true
date: 2024-01-15T00:00:00.000Z
tag:
  - database
id: 08eec07f5bf9c2b23aa5e2bab7101bf4
---
[[toc]]

## 引言

在现代实时业务中，数据处理需求日益复杂，选择适合的数据库至关重要。MySQL、PostgreSQL 和 MongoDB 是三种备受欢迎的数据库系统，它们分别以性能、扩展性和灵活性见长。理解这些数据库的特点、优势和适用场景，能够帮助企业和开发者更有效地满足业务需求。本文将从数据模型、性能、扩展性以及应用场景等多个维度，对这三种数据库进行深入对比分析。

## 简单介绍

### MySQL

MySQL 是一种广泛使用的开源关系型数据库管理系统。它采用结构化查询语言（SQL）来管理数据，并基于表格的形式存储数据。数据以行和列的形式存储在表中，每一行代表一条记录，每一列代表数据的一个属性，数据表之间通常通过外键（foreign key）来建立关系，实现数据的关联。MySQL 以其高性能、可靠性和简便的操作而著称，广泛应用于Web应用和在线事务处理（OLTP）系统。它支持主从复制、分区和多种存储引擎，使得在处理大规模数据时具有良好的表现。MySQL 适用于那些对数据一致性和事务处理有较高要求的应用。

### PostgreSQL

PostgreSQL 同样是一种功能强大的开源关系型数据库管理系统，支持复杂的查询、事务和数据完整性约束。它被广泛认为是最先进的开源关系型数据库之一，提供了对 JSON、XML 等非结构化数据的支持。PostgreSQL 的 ACID（Atomicity 原子性、Consistency 一致性、Isolation 隔离性和 Durability持久性）特性非常完善，适合需要高并发和复杂查询的应用程序。其强大的扩展性和对事务控制的支持，使得它成为数据分析、地理信息系统（GIS）等高要求应用的首选。

### MongoDB

MongoDB 是一个 NoSQL 数据库，采用文档型存储结构。与传统的关系型数据库不同，MongoDB 使用 BSON（Binary JSON）格式来存储数据。每个文档类似于一个 JSON 对象，包含了键值对（key-value）。数据可以是嵌套的，也就是说一个文档可以包含其他文档或数组。MongoDB 的优势在于其高灵活性、可扩展性以及对非结构化数据的强大支持。它允许存储和查询更复杂的文档结构，并能够在分布式系统中轻松扩展，因此特别适合处理大规模和实时数据。MongoDB 常用于大数据分析、实时应用、日志存储和内容管理等领域。

## 对比

我们可以从数据模型，基本存储单元，索引，查询语言，并发，可用性，可拓展性几个方面进行对比。

| 特性         | MySQL                           | PostgreSQL                    | MongoDB                        |
|--------------|----------------------------------|--------------------------------|--------------------------------|
| 数据模型     | 关系型数据库，表格存储           | 关系型数据库，表格存储         | NoSQL，文档型存储               |
| 基本存储单元 | 表格，行和列                    | 表格，行和列                   | 文档，键值对                    |
| 索引         | B 树索引、哈希索引等             | B 树索引、GIN、GiST 等         | 单字段索引、复合索引、全文索引等 |
| 查询语言     | SQL                              | SQL                            | MongoDB 查询语言（类似 JSON）  |
| 并发         | 行级锁、表级锁                   | 多版本并发控制（MVCC）         | 文档级并发控制                  |
| 可用性       | 主从复制、分区                   | 流复制、热备份                 | 副本集，高可用性                |
| 可拓展性     | 主从复制、分区                   | 流复制、Citus（分布式扩展）    | 水平扩展（分片）                |

### 数据模型

在数据模型方面，其实也可以这样理解，MySQL ，PostgreSQL 是关系型数据库，在关系型数据库中，数据是以表格的形式存储的，每个表都有固定的列（字段），并且每一列的数据类型、大小等都需要在创建时明确规定。

关系型数据库的特点是：

* 固定模式：关系型数据库要求在存储数据之前就定义好表结构，包括列的名称、数据类型等。如果插入的数据缺少某些字段，通常会报错，或者需要为缺少的字段指定默认值（如果字段允许空值的话）。
* 数据一致性：关系型数据库通常需要确保数据的一致性，支持 ACID（原子性、一致性、隔离性、持久性）特性。这也是关系型数据库的一大优势。

而非关系型数据库则没有固定的表结构或模式，数据可以是非结构化或半结构化的。这意味着你可以存储不同结构的数据，甚至同一个集合中的文档也可以有不同的字段，某些字段可以缺失。

非关系型数据库的特点是：

* 灵活的数据模型：非关系型数据库允许存储不同的数据结构，比如文档、键值对、列族等。在 MongoDB 中，数据以 BSON（类似 JSON）的格式存储，每个文档的字段可以是不同的，缺失字段时不会影响存储。
* 无模式约束：与关系型数据库不同，非关系型数据库不强制要求事先定义结构。即使文档中缺少某些字段，或者某些字段的数据类型不一致，数据库也能够存储这些数据。

### 索引

索引是关系数据库中对某一列或多个列的值进行预排序的数据结构。通过使用索引，可以让数据库系统不必扫描整个表，而是直接定位到符合条件的记录，这样就大大加快了查询速度。简单来说，索引类似于书本的目录，帮助你快速找到需要的内容，而不是逐页查找。

在**关系型**数据库中，索引通常用于加速对表中数据的查询。由于关系型数据库表有严格的模式（每个表的字段都已定义），索引一般会根据表中的某些列（字段）来建立。这些索引是有结构的，并且通常基于数据表中的某一列或多列来提高查询效率。

常见索引类型：

* B 树索引（B-tree Index）：这是最常用的索引类型，适用于对数据进行排序、查找范围查询等操作。
* 哈希索引（Hash Index）：适用于精确查询（例如“=`”操作符），非常高效，但不支持范围查询。
* 全文索引（Full-text Index）：用于文本搜索，适合查找某个词汇或短语。
* 联合索引（Composite Index）：当查询涉及多个列时，可以创建一个索引，包含这些列，提高多列查询的效率。

>关系型数据库的索引虽然能够高效加速查询，但其缺点在于需要占用额外的存储空间，并且在数据插入、更新或删除时会增加性能开销。索引的设计和维护较为复杂，需要根据查询需求仔细规划，选择合适的索引类型和字段组合。此外，关系型数据库在处理复杂数据类型（如 JSON 或地理空间数据）时，索引的支持较为有限。

**非关系型**数据库（如 MongoDB）也支持索引，但由于它的存储结构是灵活的（如文档存储），索引机制也更具灵活性。

常见索引类型：

* 单字段索引：类似于关系型数据库的索引，只是基于单个字段创建索引。
* 复合索引（复合字段索引）：可以基于多个字段创建索引，这样可以优化基于多个字段的查询。
* 全文索引：用于支持文本内容的搜索，类似于关系型数据库的全文索引。
* 地理空间索引：用于地理位置相关的查询（例如查找某一地点周围的范围内的对象）。

>非关系型数据库的索引具有灵活性，但这也可能导致过度索引，从而浪费系统资源，影响性能。虽然支持多种索引类型，但在处理复杂查询时，可能不如关系型数据库的索引高效，且在数据更新时也会影响写入性能。非关系型数据库的查询优化器较为简单，缺乏复杂查询的优化支持，可能导致在某些查询场景下性能不稳定。

### 并发

MySQL 使用行级锁和表级锁来管理并发操作，主要依赖其 InnoDB 存储引擎的行级锁机制。行级锁适合高并发事务处理，可以有效降低锁冲突，但在复杂查询或需要跨多行操作时可能退化为表级锁，从而降低并发性能。MySQL 的事务隔离级别支持四种模式（读未提交、读已提交、可重复读、串行化），其中默认的“可重复读”可以很好地平衡性能与一致性需求。

PostgreSQL 使用多版本并发控制（MVCC）机制，能够通过创建数据的多个版本，避免加锁引发的读写冲突。这种机制允许读取操作与写入操作并发执行，同时保证数据的一致性。由于不需要频繁加锁，PostgreSQL 在高并发场景下表现更优，特别是在需要处理复杂事务或长时间运行的查询时。

MongoDB 实现了文档级并发控制，从 MongoDB 4.0 开始支持分布式事务。这种机制适合大多数场景下的并发需求，但在高并发写入或复杂事务时，性能可能受限。此外，MongoDB 的锁机制已经从早期的全局锁优化为集合级锁甚至文档级锁，极大提升了并发性能。

### 可拓展性

MySQL 提供主从复制和分区支持，实现一定程度的水平扩展和负载均衡。其主从复制可以配置为异步或半同步，适合读写分离的应用场景。然而，MySQL 的水平扩展能力较弱，通常依赖外部工具（如 ProxySQL 或 Sharding）来实现更复杂的分片管理。

PostgreSQL 支持流复制和逻辑复制，并通过扩展（如 Citus）实现分布式架构。流复制支持实时数据同步，逻辑复制允许针对部分数据进行订阅。PostgreSQL 的内置扩展能力，使其在分布式数据处理和分片管理方面表现出色，适合需要高扩展性的大型应用。

MongoDB 原生支持水平扩展（分片），通过配置分片键将数据分布到不同的节点上，提升存储能力和查询效率。其分片机制适用于处理大规模数据和高吞吐量的场景，如物联网数据或社交媒体平台的动态内容存储。此外，MongoDB 的副本集功能也为数据的高可用性和扩展性提供了保障。

### 适用场景

MySQL 特点包括高效的查询性能、ACID 事务支持、结构化数据存储以及广泛的社区支持。它非常适合需要数据一致性和事务完整性的应用，例如电商平台、银行系统等。这些应用依赖于严格的数据关系、复杂的 SQL 查询和事务控制，MySQL 能提供良好的性能和可靠性。

PostgreSQL 支持丰富的数据类型（如 JSON、XML 和地理空间数据）、复杂查询和高并发操作。它具有强大的查询优化器和事务管理功能，适合处理复杂查询、大数据分析和多样化数据类型的应用，如地理信息系统（GIS）和数据仓库。其高并发控制能力和强大的扩展性使其成为大规模数据处理和分析的理想选择。

MongoDB 是 NoSQL 数据库，采用文档型存储，支持高效的水平扩展。它适用于快速变化的数据模型，能够轻松处理动态、非结构化的数据，且在写操作上表现出色。MongoDB 适合物联网、社交媒体平台等应用，这些应用需要处理大量的数据，并且数据结构不断变化。MongoDB 的灵活性和高扩展性使其成为这些场景的优选。

## 总结

MySQL 和 PostgreSQL 提供强大、可靠、符合 ACID 标准的关系数据存储解决方案，而 MongoDB 等 NoSQL 数据库则提供灵活、可水平扩展的替代方案。在这些数据库之间进行选择应基于应用程序的特定需求，并考虑数据完整性、性能、可伸缩性和所处理数据类型等因素。

NoSQL 不必构建数据听起来不错，直到您意识到大多数应用程序都有结构化（和关系）数据。这就像扔掉你所有的衣服、毛巾、袜子一样,...一堆，而不是将它们整齐地放在衣柜的不同隔间中。简单快捷，但难以管理。公平地说，NoSQL 有它们的用途，但大多数时候它不是你想要的。因此，如果你有结构化和关系数据，应该永远选择 SQL，除非你有充分的理由不这样做。当然，NoSQL也不是不好，只是通常不适用于我们，它只适用于两种情况：

* 你的数据不是关系型
* 你有巨大的规模。

## 参考文献

[https://liaoxuefeng.com/books/sql/relational/index/](https://liaoxuefeng.com/books/sql/relational/index/)
[https://vercel.com/guides/mysql-vs-postgresql-vs-mongodb](https://vercel.com/guides/mysql-vs-postgresql-vs-mongodb)
[https://www.reddit.com/r/webdev/comments/1ddwofb/postgres_vs_mongodb_vs_mysql_vs_etc/?rdt=51788](https://www.reddit.com/r/webdev/comments/1ddwofb/postgres_vs_mongodb_vs_mysql_vs_etc/?rdt=51788)